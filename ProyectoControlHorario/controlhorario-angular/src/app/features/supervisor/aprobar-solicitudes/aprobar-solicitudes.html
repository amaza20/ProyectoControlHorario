<nav class="navbar">
  <div class="nav-brand">ğŸ• Control Horario</div>
  <div class="nav-user">{{ (authService.currentUser$ | async)?.username }} ({{ (authService.currentUser$ | async)?.rol }})</div>
</nav>

<div class="container" style="margin-top: 100px;">
  <div class="back-link">
    <a (click)="goToDashboard()" style="cursor: pointer;">â† Volver al Dashboard</a>
  </div>

  <h1 style="text-align: center; color: white; margin-bottom: 10px;">âœ… Aprobar Solicitudes</h1>
  <p style="text-align: center; color: white; margin-bottom: 30px;">Revisar ediciones pendientes</p>

  <!-- Loading -->
  <div *ngIf="isLoading" style="text-align: center; padding: 40px;">
    <div class="loading-spinner"></div>
    <p style="color: white; margin-top: 15px;">Cargando solicitudes...</p>
  </div>

  <!-- Error -->
  <div *ngIf="errorMessage" class="response error" style="display: block; margin:  20px auto; max-width: 600px;">
    {{ errorMessage }}
  </div>

  <!-- Tabla de solicitudes -->
  <div *ngIf="! isLoading && solicitudes.length > 0" style="background: white; padding: 20px; border-radius: 12px; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
    <table>
      <thead>
        <tr>
          <th style="text-align: center;">ID</th>
          <th>Usuario</th>
          <th>Instante Original</th>
          <th>Nuevo Instante</th>
          <th style="text-align: center;">Tipo</th>
          <th style="text-align: center;">Estado</th>
          <th style="text-align: center;">AcciÃ³n</th>
        </tr>
      </thead>
      <tbody>
        <tr *ngFor="let solicitud of solicitudes; let i = index"
            [style.background]="i % 2 === 0 ? '#f8f9fa' : 'white'">
          
          <td style="text-align: center;"><strong>{{ solicitud.id }}</strong></td>
          <td>{{ solicitud.username }}</td>
          <td style="color: #dc3545; text-decoration: line-through;">
            {{ solicitud.instante_original | fechaLocal }}
          </td>
          <td style="color: #007bff; font-weight: 500;">
            {{ solicitud. nuevo_instante | fechaLocal }}
          </td>
          <td style="text-align:  center;">
            <span style="background: #e3f2fd; padding: 4px 8px; border-radius: 4px;">
              {{ solicitud.tipo }}
            </span>
          </td>
          <td style="text-align: center;">
            <span *ngIf="solicitud.aprobado. toUpperCase() === 'APROBADO'" 
                  style="color: #28a745; font-weight: bold;">âœ… Aprobada</span>
            <span *ngIf="solicitud.aprobado.toUpperCase() === 'RECHAZADO'" 
                  style="color: #dc3545; font-weight:  bold;">âŒ Rechazada</span>
            <span *ngIf="solicitud.aprobado.toUpperCase() === 'PENDIENTE'" 
                  style="color: #ff9800; font-weight: bold;">â³ Pendiente</span>
          </td>
          <td style="text-align: center;">
            <div *ngIf="solicitud.aprobado.toUpperCase() === 'PENDIENTE'" 
                 style="display: flex; gap: 8px; justify-content: center; flex-wrap: wrap;">
              <button class="btn btn-success btn-sm" 
                      (click)="aprobarSolicitud(solicitud. id)"
                      style="flex: 1; min-width:  80px;">
                âœ… Aprobar
              </button>
              <button class="btn btn-danger btn-sm" 
                      (click)="rechazarSolicitud(solicitud.id)"
                      style="flex: 1; min-width: 80px;">
                âŒ Rechazar
              </button>
            </div>
            
            <span *ngIf="solicitud. aprobado.toUpperCase() === 'APROBADO'" 
                  style="color:  #28a745;">âœ… Aprobada</span>
            <span *ngIf="solicitud.aprobado.toUpperCase() === 'RECHAZADO'" 
                  style="color: #dc3545;">âŒ Rechazada</span>
          </td>
        </tr>
      </tbody>
    </table>

    <!-- PaginaciÃ³n -->
    <div class="pagination-controls">
      <button 
        class="btn btn-secondary"
        (click)="paginaAnterior()"
        [disabled]="paginaActual === 0"
        [style.opacity]="paginaActual === 0 ? '0.5' :  '1'"
        [style.cursor]="paginaActual === 0 ? 'not-allowed' : 'pointer'">
        â† Anterior
      </button>
      
      <span style="color: #666; font-weight: 500;">
        PÃ¡gina {{ paginaActual + 1 }}
        <span style="font-size: 0.9em; color: #999;">({{ solicitudes.length }} solicitud{{ solicitudes.length !== 1 ? 'es' : '' }})</span>
      </span>
      
      <button 
        class="btn btn-secondary"
        (click)="paginaSiguiente()"
        [disabled]="! hayMasPaginas"
        [style.opacity]="! hayMasPaginas ? '0.5' : '1'"
        [style.cursor]="!hayMasPaginas ?  'not-allowed' : 'pointer'">
        Siguiente â†’
      </button>
    </div>

    <div style="text-align: center; margin-top: 15px;">
      <label for="elementosPorPagina" style="color: #666; margin-right: 10px;">Solicitudes por pÃ¡gina:</label>
      <select 
        id="elementosPorPagina"
        (change)="cambiarElementosPorPagina($event)"
        [value]="elementosPorPagina"
        style="padding: 5px 10px; border-radius: 5px; border: 1px solid #ddd;">
        <option [value]="5">5</option>
        <option [value]="10">10</option>
        <option [value]="20">20</option>
        <option [value]="50">50</option>
      </select>
    </div>
  </div>

  <!-- Sin solicitudes -->
  <div *ngIf="!isLoading && solicitudes.length === 0" 
       style="background: white; padding: 40px; border-radius: 12px; text-align: center; box-shadow: 0 4px 8px rgba(0,0,0,0.1);">
    <p style="color: #666; font-size: 1.1em;">No hay solicitudes en este momento</p>
  </div>
</div>
