<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Dashboard - Control Horario</title>
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <nav class="navbar">
        <div class="nav-brand">ğŸ• Control Horario</div>
        <div class="nav-user" id="navUser">Cargando...</div>
    </nav>
    
    <div class="container">
        <h1 style="text-align: center; margin-bottom: 10px;">Panel de Control</h1>
        <p id="userInfo" style="text-align: center; color: #ffffff; margin-bottom: 40px; font-size: 1.1em; font-weight: 500; text-shadow: 0 2px 4px rgba(0,0,0,0.3);">Cargando...</p>
        
        <div class="dashboard-grid" id="dashboardOptions">
            <!-- Las opciones se cargarÃ¡n dinÃ¡micamente segÃºn el rol -->
        </div>
        
        <div style="text-align: center; margin-top: 40px;">
            <button class="btn btn-secondary" onclick="cerrarSesion()">ğŸšª Cerrar SesiÃ³n</button>
        </div>
    </div>
    
    <script src="script.js"></script>
    <script>
        // Verificar sesiÃ³n
        if (!verificarSesion()) {
            window. location.href = 'login. html';
        }
        
        // Obtener datos del usuario
        const datos = obtenerDatosToken();
        
        if (datos) {
            // Mostrar informaciÃ³n del usuario
            document.getElementById('navUser').textContent = `${datos.username} (${datos.rol})`;
            document.getElementById('userInfo').textContent = `Rol: ${datos.rol}${datos.departamento ? ' - Departamento: ' + datos.departamento : ''}`;
            
            // Cargar opciones segÃºn el rol
            cargarOpcionesDashboard(datos.rol);
        } else {
            window.location.href = 'login.html';
        }
        
        function cargarOpcionesDashboard(rol) {
            const container = document.getElementById('dashboardOptions');
            let opciones = '';
            
            // Opciones comunes para Empleado y Supervisor
            if (rol === 'Empleado' || rol === 'Supervisor') {
                opciones += `
                    <div class="dashboard-card" onclick="window.location.href='fichar.html'">
                        <div class="icon">â°</div>
                        <h3>Fichar</h3>
                        <p>Registra tu entrada o salida</p>
                    </div>
                    
                    <div class="dashboard-card" onclick="window.location. href='fichajes.html'">
                        <div class="icon">ğŸ“‹</div>
                        <h3>Ver Fichajes</h3>
                        <p>Consulta tu historial</p>
                    </div>
                `;
            }
            
            // OpciÃ³n exclusiva para Supervisor
            if (rol === 'Supervisor') {
                opciones += `
                    <div class="dashboard-card" onclick="window.location.href='aprobar-solicitudes.html'">
                        <div class="icon">âœ…</div>
                        <h3>Aprobar Solicitudes</h3>
                        <p>Revisar ediciones pendientes</p>
                    </div>

                    <!-- âœ… NUEVO: Verificar Integridad Fichajes -->
                    <div class="dashboard-card" onclick="window.location.href='verificar-integridad.html'">
                        <div class="icon">ğŸ”</div>
                        <h3>Verificar Integridad Fichajes</h3>
                        <p>Comprobar blockchain de fichajes</p>
                    </div>
                    
                    <!-- âœ… NUEVO: Verificar Integridad Ediciones -->
                    <div class="dashboard-card" onclick="window. location.href='verificar-integridad-ediciones.html'">
                        <div class="icon">ğŸ”’</div>
                        <h3>Verificar Integridad Ediciones</h3>
                        <p>Comprobar blockchain de ediciones</p>
                    </div>
                `;
            }
            
            // Opciones para Auditor
            if (rol === 'Auditor') {
                opciones += `
                    <div class="dashboard-card" onclick="window.location.href='verificar-integridad.html'">
                        <div class="icon">ğŸ”</div>
                        <h3>Verificar Integridad</h3>
                        <p>Comprobar autenticidad de fichajes</p>
                    </div>

                    <!-- âœ… NUEVO: Verificar Integridad Ediciones -->
                    <div class="dashboard-card" onclick="window.location.href='verificar-integridad-ediciones.html'">
                        <div class="icon">ğŸ”’</div>
                        <h3>Verificar Integridad Ediciones</h3>
                        <p>Comprobar blockchain de ediciones</p>
                    </div>
                `;
            }
            
            // Opciones para Administrador
            if (rol === 'Administrador') {
                opciones += `
                   <div class="dashboard-card" onclick="window.location.href='registro.html'">
                        <div class="icon">ğŸ‘¤</div>
                        <h3>Registrar Usuario</h3>
                        <p>Crear nuevos usuarios</p>
                    </div>
        
                    <div class="dashboard-card" onclick="window.location.href='crear-departamento.html'">
                        <div class="icon">ğŸ¢</div>
                        <h3>Crear Departamento</h3>
                        <p>Agregar nuevos departamentos</p>
                    </div>

                    <div class="dashboard-card" onclick="window.location.href='cambiar-password.html'">
                        <div class="icon">ğŸ”‘</div>
                        <h3>Cambiar ContraseÃ±a</h3>
                        <p>Cambiar contraseÃ±a de usuarios</p>
                    </div>
        
                    <div class="dashboard-card" onclick="window.location.href='verificar-integridad.html'">
                        <div class="icon">ğŸ”</div>
                        <h3>Verificar Integridad</h3>
                        <p>Comprobar autenticidad de fichajes</p>
                     </div>

                     <!-- âœ… NUEVO: Verificar Integridad Ediciones -->
                    <div class="dashboard-card" onclick="window.location.href='verificar-integridad-ediciones.html'">
                        <div class="icon">ğŸ”’</div>
                        <h3>Verificar Integridad Ediciones</h3>
                        <p>Comprobar blockchain de ediciones</p>
                    </div>
                `;
            }
            
            // BotÃ³n de cerrar sesiÃ³n (para todos)
            opciones += `
                <div class="dashboard-card" onclick="cerrarSesion()" style="background: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);">
                    <div class="icon">ğŸšª</div>
                    <h3>Salir</h3>
                    <p>Cerrar sesiÃ³n</p>
                </div>
            `;
            
            container.innerHTML = opciones;
        }
    </script>
</body>
</html>